<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City of Heroes Planner</title>
    <link rel="icon" href="img/Unknown.png">
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/stats.css">
    <link rel="stylesheet" href="css/modals.css">
</head>
<body>
    <div class="container">
        <!-- Top Panel -->
        <div class="top-panel">
            <input type="text" id="buildName" placeholder="Build Name" value="Fire/Fire Blaster Build">
            
            <select id="archetypeSelect" onchange="onArchetypeChange()">
                <option value="">Select Archetype...</option>
            </select>
            
            <select id="primarySelect" onchange="onPrimaryChange()" disabled>
                <option value="">Select Primary...</option>
            </select>
            
            <select id="secondarySelect" onchange="onSecondaryChange()" disabled>
                <option value="">Select Secondary...</option>
            </select>

            <div class="io-level-setting">
                <label>Enh Level:</label>
                <input type="number" min="10" max="53" value="50" id="globalIOLevel" oninput="updateGlobalIOLevel()">
            </div>

            <div class="level-info">
                <label>Progression Mode:</label>
                <select id="progressionMode" onchange="changeProgressionMode()">
                    <option value="auto">Auto-Level (Recommended)</option>
                    <option value="freeform">Freeform</option>
                </select>
                <label>Character Level: <span id="charLevel">1</span></label>
            </div>

            <div class="resource-badge">
                Slots: <span>67/67</span>
            </div>
            <button class="debug-btn" onclick="debugFireFire()" style="margin-left: 10px; padding: 6px 12px; background: #ff6b35; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">üî• Fire/Fire Debug</button>
        </div>

        <!-- Stats Dashboard Row -->
        <div class="stats-dashboard">
            <div class="stats-dashboard-items">
                <div class="stat-item">
                    <div class="stat-label stat-damage">Damage</div>
                    <div class="stat-value">+95.3%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-accuracy">Accuracy</div>
                    <div class="stat-value">+42.7%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-recharge">Recharge</div>
                    <div class="stat-value">+75.1%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-defense">Defense</div>
                    <div class="stat-value">38.5%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-resistance">Resistance</div>
                    <div class="stat-value">25.0%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-recovery">Recovery</div>
                    <div class="stat-value">+45.0%</div>
                </div>
            </div>
            <div class="stats-dashboard-actions">
                <button class="stats-btn" onclick="openStatsSelector()">
                    <span>‚öô</span> Configure Stats
                </button>
                <button class="stats-btn" onclick="openStatsDetail()">
                    <span>üìä</span> Detailed View
                </button>
            </div>
        </div>

        <!-- Main Columns -->
        <div class="columns">
            <!-- Column A: Available Powers -->
            <div class="column">
                <div class="column-header">Available Powers</div>
                <div class="column-content">
                    <div id="availablePrimaryPowers" style="margin-bottom: 12px;">
                        <!-- Primary powers will be populated here -->
                    </div>

                    <div id="availableSecondaryPowers">
                        <!-- Secondary powers will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Column B: Primary Powers -->
            <div class="column">
                <div class="column-header">Primary Powers</div>
                
                <div class="column-content" id="selectedPrimaryPowers">
                    <!-- Selected primary powers will be populated here -->
                </div>
            </div>

            <!-- Column C: Secondary Powers -->
            <div class="column">
                <div class="column-header">Secondary Powers</div>
                
                <div class="column-content" id="selectedSecondaryPowers">
                    <!-- Selected secondary powers will be populated here -->
                </div>
            </div>

            <!-- Column D: Pool Powers -->
            <div class="column">
                <div class="column-header">Pool Powers</div>
                
                <div class="column-content">
                    <!-- Pool powers will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Enhancement Picker Modal -->
    <div class="modal-overlay" id="modal" onclick="closeModal()">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title">
                    <button class="back-button" id="backBtn" onclick="goBack()">‚Üê</button>
                    <span id="modalTitle">Choose an enhancement</span>
                </div>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>

            <!-- Interaction hints immediately below the modal header -->
            <div class="modal-hints" aria-hidden="true">
                <div class="hints-inner">
                    <div class="hint-row"><strong>Left-Click</strong>		Slot an enhancement</div>
                    <div class="hint-row"><strong>Shift + Left-Click</strong>	Slot all enhancements in the group</div>
                    <div class="hint-row"><strong>Left-Click and drag</strong>	Select a variable group</div>
                </div>
            </div>

            <div class="modal-body">
                

                <!-- SELECTION VIEW: IO Sets (single instance) -->
                <div class="selection-view" id="selectionViewSets">
                    <div class="types-panel">
                        <div class="group-filters">
                            <div class="type-option group-filter-option selected" data-category="io-set">All Sets</div>
                            <div class="types-list">
                                <!-- Subcategory buttons (Ranged Damage, Universal Damage, etc.) are injected here -->
                            </div>
                            <div class="type-option group-filter-option" data-category="very-rare">Very Rare</div>
                            <div class="type-option group-filter-option" data-category="event">Event / Winter</div>
                            <div class="type-option group-filter-option" data-category="archetype">Archetype</div>
                            <div class="type-option group-filter-option" data-category="special">Special</div>
                            <div class="type-option group-filter-option" data-category="io-generic">Common IO</div>
                            <div class="type-option group-filter-option" data-category="to-do-so">SO/DO/TO</div>

                            
                        </div>
                    </div>

                    <div class="sets-panel">
                        <!-- Sets loaded dynamically as rows -->
                    </div>
                </div>

                <!-- Deprecated separate selection views removed; content renders inline in the sets panel -->

                </div>
            </div>
        </div>

        <!-- Tooltip -->
        <div class="tooltip" id="tooltip"></div>

    <!-- JavaScript Files -->
    <script src="js/data/archetypes.js"></script>
    <script src="js/data/powersets.js"></script>
    
    <!-- Blaster Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/archery.js?v=2"></script>
    <script src="js/data/powersets/assault-rifle.js"></script>
    <script src="js/data/powersets/beam-rifle.js"></script>
    <script src="js/data/powersets/dark-blast.js"></script>
    <script src="js/data/powersets/dual-pistols.js"></script>
    <script src="js/data/powersets/electrical-blast.js"></script>
    <script src="js/data/powersets/energy-blast.js"></script>
    <script src="js/data/powersets/fire-blast.js"></script>
    <script src="js/data/powersets/ice-blast.js"></script>
    <script src="js/data/powersets/psychic-blast.js"></script>
    <script src="js/data/powersets/radiation-blast.js"></script>
    <script src="js/data/powersets/seismic-blast.js"></script>
    <script src="js/data/powersets/sonic-attack.js"></script>
    <script src="js/data/powersets/storm-blast.js"></script>
    <script src="js/data/powersets/water-blast.js"></script>
    
    <!-- Blaster Secondary Powersets (Alphabetical) -->
    <script src="js/data/powersets/darkness-manipulation.js"></script>
    <script src="js/data/powersets/earth-manipulation.js"></script>
    <script src="js/data/powersets/electricity-manipulation.js"></script>
    <script src="js/data/powersets/energy-manipulation.js"></script>
    <script src="js/data/powersets/fire-manipulation.js"></script>
    <script src="js/data/powersets/gadgets.js"></script>
    <script src="js/data/powersets/ice-manipulation.js"></script>
    <script src="js/data/powersets/martial-manipulation.js"></script>
    <script src="js/data/powersets/mental-manipulation.js"></script>
    <script src="js/data/powersets/ninja-training.js"></script>
    <script src="js/data/powersets/plant-manipulation.js"></script>
    <script src="js/data/powersets/radiation-manipulation.js"></script>
    <script src="js/data/powersets/sonic-manipulation.js"></script>
    <script src="js/data/powersets/tactical-arrow.js"></script>
    <script src="js/data/powersets/temporal-manipulation.js"></script>
    
    <!-- Scrapper Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/battle-axe.js"></script>
    <script src="js/data/powersets/brawling.js"></script>
    <script src="js/data/powersets/broad-sword.js"></script>
    <script src="js/data/powersets/claws.js"></script>
    <script src="js/data/powersets/dark-melee.js"></script>
    <script src="js/data/powersets/dual-blades.js"></script>
    <script src="js/data/powersets/electrical-melee.js"></script>
    <script src="js/data/powersets/energy-melee.js"></script>
    <script src="js/data/powersets/fiery-melee.js"></script>
    <script src="js/data/powersets/ice-melee.js"></script>
    <script src="js/data/powersets/katana.js"></script>
    <script src="js/data/powersets/kinetic-attack.js"></script>
    <script src="js/data/powersets/martial-arts.js"></script>
    <script src="js/data/powersets/psionic-melee.js"></script>
    <script src="js/data/powersets/quills.js"></script>
    <script src="js/data/powersets/radiation-melee.js"></script>
    <script src="js/data/powersets/savage-melee.js"></script>
    <script src="js/data/powersets/staff-fighting.js"></script>
    <script src="js/data/powersets/stone-melee.js"></script>
    <script src="js/data/powersets/titan-weapons.js"></script>
    <script src="js/data/powersets/war-mace.js"></script>
    
    <!-- Scrapper Secondary Powersets (Alphabetical) -->
    <script src="js/data/powersets/bio-organic-armor.js"></script>
    <script src="js/data/powersets/dark-armor.js"></script>
    <script src="js/data/powersets/electric-armor.js"></script>
    <script src="js/data/powersets/energy-aura.js"></script>
    <script src="js/data/powersets/fiery-aura.js"></script>
    <script src="js/data/powersets/ice-armor.js"></script>
    <script src="js/data/powersets/invulnerability.js"></script>
    <script src="js/data/powersets/ninjitsu.js"></script>
    <script src="js/data/powersets/psionic-armor.js"></script>
    <script src="js/data/powersets/radiation-armor.js"></script>
    <script src="js/data/powersets/regeneration.js"></script>
    <script src="js/data/powersets/shield-defense.js"></script>
    <script src="js/data/powersets/stone-armor.js"></script>
    <script src="js/data/powersets/super-reflexes.js"></script>
    <script src="js/data/powersets/willpower.js"></script>
    
    <!-- Defender Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/cold-domination.js"></script>
    <script src="js/data/powersets/dark-miasma.js"></script>
    <script src="js/data/powersets/empathy.js"></script>
    <script src="js/data/powersets/force-field.js"></script>
    <script src="js/data/powersets/kinetics.js"></script>
    <script src="js/data/powersets/marine-affinity.js"></script>
    <script src="js/data/powersets/nature-affinity.js"></script>
    <script src="js/data/powersets/pain-domination.js"></script>
    <script src="js/data/powersets/poison.js"></script>
    <script src="js/data/powersets/radiation-emission.js"></script>
    <script src="js/data/powersets/shock-therapy.js"></script>
    <script src="js/data/powersets/sonic-debuff.js"></script>
    <script src="js/data/powersets/storm-summoning.js"></script>
    <script src="js/data/powersets/thermal-radiation.js"></script>
    <script src="js/data/powersets/time-manipulation.js"></script>
    <script src="js/data/powersets/traps.js"></script>
    <script src="js/data/powersets/trick-arrow.js"></script>
    <!-- Note: Defender secondaries use Blaster primaries (already loaded above) -->
    
    <!-- Controller Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/arsenal-control.js"></script>
    <script src="js/data/powersets/darkness-control.js"></script>
    <script src="js/data/powersets/earth-control.js"></script>
    <script src="js/data/powersets/electric-control.js"></script>
    <script src="js/data/powersets/fire-control.js"></script>
    <script src="js/data/powersets/gravity-control.js"></script>
    <script src="js/data/powersets/ice-control.js"></script>
    <script src="js/data/powersets/illusion-control.js"></script>
    <script src="js/data/powersets/mind-control.js"></script>
    <script src="js/data/powersets/plant-control.js"></script>
    <script src="js/data/powersets/pyrotechnic-control.js"></script>
    <script src="js/data/powersets/symphony-control.js"></script>
    <script src="js/data/powersets/wind-control.js"></script>
    
    <!-- Controller Secondary Powersets -->
    <script src="js/data/powersets/darkness-affinity.js"></script>
    <!-- Note: Other Controller secondaries use Defender primaries (already loaded above) -->
    
    <!-- Tanker Secondary Powersets (Melee) -->
    <script src="js/data/powersets/spines.js"></script>
    <script src="js/data/powersets/super-strength.js"></script>
    <!-- Note: Tanker primaries use Scrapper secondaries (already loaded above) -->
    <!-- Note: Other Tanker secondaries use Scrapper primaries (already loaded above) -->
    
    <!-- Sentinel Powersets -->
    <!-- Note: Sentinel primaries use Blaster primaries (already loaded above) -->
    <!-- Note: Sentinel secondaries use Scrapper secondaries (already loaded above) -->
    
    <!-- Dominator Secondary Powersets (Assault) -->
    <script src="js/data/powersets/arsenal-assault.js"></script>
    <script src="js/data/powersets/dark-assault.js"></script>
    <script src="js/data/powersets/earth-assault.js"></script>
    <script src="js/data/powersets/electricity-assault.js"></script>
    <script src="js/data/powersets/energy-assault.js"></script>
    <script src="js/data/powersets/fiery-assault.js"></script>
    <script src="js/data/powersets/icy-assault.js"></script>
    <script src="js/data/powersets/martial-assault.js"></script>
    <script src="js/data/powersets/psionic-assault.js"></script>
    <script src="js/data/powersets/radioactive-assault.js"></script>
    <script src="js/data/powersets/savage-assault.js"></script>
    <script src="js/data/powersets/sonic-assault.js"></script>
    <script src="js/data/powersets/thorny-assault.js"></script>
    <!-- Note: Dominator primaries use Controller primaries (already loaded above) -->
    
    <!-- Brute Powersets -->
    <!-- Note: Brute primaries use Scrapper primaries + Tanker exclusives (already loaded above) -->
    <!-- Note: Brute secondaries use Scrapper secondaries (already loaded above) -->
    
    <!-- Corruptor Secondary Powersets (Buff/Debuff) -->
    <script src="js/data/powersets/sonic-resonance.js"></script>
    <!-- Note: Corruptor primaries use Blaster primaries (already loaded above) -->
    <!-- Note: Other Corruptor secondaries use Defender primaries (already loaded above) -->
    
    <!-- Stalker Primary Powersets (Melee) -->
    <script src="js/data/powersets/ninja-sword.js"></script>
    <!-- Note: Other Stalker primaries use Scrapper primaries (already loaded above) -->
    <!-- Note: Stalker secondaries use Scrapper secondaries (already loaded above) -->
    
    <!-- Mastermind Primary Powersets (Pet Summoning) -->
    <script src="js/data/powersets/beast-mastery.js"></script>
    <script src="js/data/powersets/demon-summoning.js"></script>
    <script src="js/data/powersets/mercenaries.js"></script>
    <script src="js/data/powersets/necromancy.js"></script>
    <script src="js/data/powersets/ninjas.js"></script>
    <script src="js/data/powersets/robotics.js"></script>
    <script src="js/data/powersets/thugs.js"></script>
    <!-- Note: Mastermind secondaries use Defender/Controller primaries (already loaded above) -->
    
    <!-- Powerset Auto-Loader (registers all loaded powersets) -->
    <script src="js/data/powersets-loader.js"></script>
    
    <script src="js/data/power-pools.js"></script>
    <script src="js/data/io-sets.js"></script>
    <script src="js/data/enhancements.js"></script>
    <script src="js/data/level-progression.js"></script>
    <script src="js/app.js"></script>
    <script src="js/build.js"></script>
    <script src="js/icons.js"></script>
    <script src="js/damage-calculation.js"></script>  <!-- Damage calculation with level tables -->
    <script src="js/ui.js"></script>  <!-- MOVED BEFORE character-creator.js -->
    <script src="js/enhancement-values.js"></script>  <!-- Enhancement value parsing and calculations -->
    <script src="js/tooltips/unified-tooltips.js"></script>
    <script src="js/tooltips/tooltip-improvements.js"></script>
    <script src="js/character-creator.js"></script>
    <script src="js/enhancement-filtering.js"></script>
    <script src="js/drag-selection.js"></script>
    <script src="js/enhancement-selector.js"></script>
    <script src="js/rule-of-five.js"></script>
    <script src="js/stats.js"></script>
    <script src="js/debug.js"></script>
</body>
</html>
