<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City of Heroes Planner</title>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/stats.css">
    <link rel="stylesheet" href="css/modals.css">
</head>
<body>
    <div class="container">
        <!-- Top Panel -->
        <div class="top-panel">
            <input type="text" id="buildName" placeholder="Build Name" value="Fire/Fire Blaster Build">
            
            <select id="archetypeSelect" onchange="onArchetypeChange()">
                <option value="">Select Archetype...</option>
            </select>
            
            <select id="primarySelect" onchange="onPrimaryChange()" disabled>
                <option value="">Select Primary...</option>
            </select>
            
            <select id="secondarySelect" onchange="onSecondaryChange()" disabled>
                <option value="">Select Secondary...</option>
            </select>

            <div class="io-level-setting">
                <label>Enh Level:</label>
                <input type="number" min="10" max="53" value="50" id="globalIOLevel" oninput="updateGlobalIOLevel()">
            </div>

            <div class="level-info">
                <label>Progression Mode:</label>
                <select id="progressionMode" onchange="changeProgressionMode()">
                    <option value="auto">Auto-Level (Recommended)</option>
                    <option value="freeform">Freeform</option>
                </select>
                <label>Character Level: <span id="charLevel">1</span></label>
            </div>

            <div class="resource-badge">
                Slots: <span>67/67</span>
            </div>
            <button class="debug-btn" onclick="debugFireFire()" style="margin-left: 10px; padding: 6px 12px; background: #ff6b35; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">üî• Fire/Fire Debug</button>
        </div>

        <!-- Stats Dashboard Row -->
        <div class="stats-dashboard">
            <div class="stats-dashboard-items">
                <div class="stat-item">
                    <div class="stat-label stat-damage">Damage</div>
                    <div class="stat-value">+95.3%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-accuracy">Accuracy</div>
                    <div class="stat-value">+42.7%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-recharge">Recharge</div>
                    <div class="stat-value">+75.1%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-defense">Defense</div>
                    <div class="stat-value">38.5%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-resistance">Resistance</div>
                    <div class="stat-value">25.0%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label stat-recovery">Recovery</div>
                    <div class="stat-value">+45.0%</div>
                </div>
            </div>
            <div class="stats-dashboard-actions">
                <button class="stats-btn" onclick="openStatsSelector()">
                    <span>‚öô</span> Configure Stats
                </button>
                <button class="stats-btn" onclick="openStatsDetail()">
                    <span>üìä</span> Detailed View
                </button>
            </div>
        </div>

        <!-- Main Columns -->
        <div class="columns">
            <!-- Column A: Available Powers -->
            <div class="column">
                <div class="column-header">Available Powers</div>
                <div class="column-content">
                    <div id="availablePrimaryPowers" style="margin-bottom: 12px;">
                        <!-- Primary powers will be populated here -->
                    </div>

                    <div id="availableSecondaryPowers">
                        <!-- Secondary powers will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Column B: Primary Powers -->
            <div class="column">
                <div class="column-header">Primary Powers</div>
                <div class="column-content" id="selectedPrimaryPowers">
                    <!-- Selected primary powers will be populated here -->
                </div>
            </div>

            <!-- Column C: Secondary Powers -->
            <div class="column">
                <div class="column-header">Secondary Powers</div>
                <div class="column-content" id="selectedSecondaryPowers">
                    <!-- Selected secondary powers will be populated here -->
                </div>
            </div>

            <!-- Column D: Pool Powers -->
            <div class="column">
                <div class="column-header">Pool Powers</div>
                <div class="column-content">
                    <!-- Pool powers will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Enhancement Picker Modal -->
    <div class="modal-overlay" id="modal" onclick="closeModal()">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title">
                    <button class="back-button" id="backBtn" onclick="goBack()">‚Üê</button>
                    <span id="modalTitle">Choose an enhancement</span>
                </div>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>

            <div class="modal-body">
                <!-- CATEGORY VIEW -->
                <div class="category-view" id="categoryView">
                    <div class="category-grid">
                        <div class="category-option" onclick="selectCategory('io-set')">
                            <div class="category-name">IO set</div>
                        </div>

                        <div class="category-option" onclick="selectCategory('very-rare')">
                            <div class="category-name">Very rare</div>
                            <div class="category-hint">Purple/PvP sets</div>
                        </div>

                        <div class="category-option" onclick="selectCategory('event')">
                            <div class="category-name">Event</div>
                            <div class="category-hint">Winter sets</div>
                        </div>

                        <div class="category-option" onclick="selectCategory('archetype')">
                            <div class="category-name">Archetype</div>
                            <div class="category-hint">Blaster ATOs</div>
                        </div>
                    </div>

                    <div class="category-grid">
                        <div class="category-option" onclick="selectCategory('io-generic')">
                            <div class="category-name">IO generic</div>
                        </div>

                        <div class="category-option" onclick="selectCategory('special')">
                            <div class="category-name">Special</div>
                            <div class="category-hint">Hamidon</div>
                        </div>

                        <div class="category-option" onclick="selectCategory('to-do-so')">
                            <div class="category-name">TO/DO/SO</div>
                        </div>
                    </div>
                </div>

                <!-- SELECTION VIEW: IO Sets -->
                <div class="selection-view" id="selectionViewSets">
                    <div class="types-panel">
                        <div class="types-title">Types</div>
                        <div class="type-option selected">ranged aoe</div>
                        <div class="type-option">tohit debuff</div>
                        <div class="type-option">knockback</div>
                    </div>

                    <div class="sets-panel">
                        <!-- Sets loaded dynamically as rows -->
                    </div>
                </div>

                <!-- SELECTION VIEW: IO Sets -->
                <div class="selection-view" id="selectionViewSets">
                    <div class="types-panel">
                        <div class="types-title">Types</div>
                        <div class="type-option selected">ranged aoe</div>
                        <div class="type-option">tohit debuff</div>
                        <div class="type-option">knockback</div>
                    </div>

                    <div class="sets-panel">
                        <!-- Sets loaded dynamically as icon grid -->
                    </div>
                </div>

                <!-- SELECTION VIEW: IO Generic -->
                <div class="selection-view" id="selectionViewGeneric">
                    <div class="generic-grid">
                        <!-- Icons loaded dynamically -->
                    </div>
                </div>

                <!-- SELECTION VIEW: Special -->
                <div class="selection-view" id="selectionViewSpecial">
                    <div class="special-grid">
                        <!-- Icons loaded dynamically -->
                    </div>
                </div>

                <!-- SELECTION VIEW: TO/DO/SO -->
                <div class="selection-view" id="selectionViewSO">
                    <div class="so-grid">
                        <!-- Icons loaded dynamically -->
                    </div>
                </div>

                </div>
            </div>
        </div>

        <!-- Tooltip -->
    <div class="tooltip" id="tooltip"></div>

    <!-- JavaScript Files -->
    <script src="js/data/archetypes.js"></script>
    <script src="js/data/powersets.js"></script>
    
    <!-- Blaster Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/archery.js?v=3"></script>
    <script src="js/data/powersets/assault-rifle.js?v=3"></script>
    <script src="js/data/powersets/beam-rifle.js?v=3"></script>
    <script src="js/data/powersets/dark-blast.js?v=3"></script>
    <script src="js/data/powersets/dual-pistols.js?v=3"></script>
    <script src="js/data/powersets/electrical-blast.js?v=3"></script>
    <script src="js/data/powersets/energy-blast.js?v=3"></script>
    <script src="js/data/powersets/fire-blast.js?v=3"></script>
    <script src="js/data/powersets/ice-blast.js?v=3"></script>
    <script src="js/data/powersets/psychic-blast.js?v=3"></script>
    <script src="js/data/powersets/radiation-blast.js?v=3"></script>
    <script src="js/data/powersets/seismic-blast.js?v=3"></script>
    <script src="js/data/powersets/sonic-attack.js?v=3"></script>
    <script src="js/data/powersets/storm-blast.js?v=3"></script>
    <script src="js/data/powersets/water-blast.js?v=3"></script>
    
    <!-- Blaster Secondary Powersets (Alphabetical) -->
    <script src="js/data/powersets/darkness-manipulation.js?v=3"></script>
    <script src="js/data/powersets/earth-manipulation.js?v=3"></script>
    <script src="js/data/powersets/electricity-manipulation.js?v=3"></script>
    <script src="js/data/powersets/energy-manipulation.js?v=3"></script>
    <script src="js/data/powersets/fire-manipulation.js?v=3"></script>
    <script src="js/data/powersets/gadgets.js?v=3"></script>
    <script src="js/data/powersets/ice-manipulation.js?v=3"></script>
    <script src="js/data/powersets/martial-manipulation.js?v=3"></script>
    <script src="js/data/powersets/mental-manipulation.js?v=3"></script>
    <script src="js/data/powersets/ninja-training.js?v=3"></script>
    <script src="js/data/powersets/plant-manipulation.js?v=3"></script>
    <script src="js/data/powersets/radiation-manipulation.js?v=3"></script>
    <script src="js/data/powersets/sonic-manipulation.js?v=3"></script>
    <script src="js/data/powersets/tactical-arrow.js?v=3"></script>
    <script src="js/data/powersets/temporal-manipulation.js?v=3"></script>
    
    <!-- Scrapper Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/battle-axe.js?v=3"></script>
    <script src="js/data/powersets/brawling.js?v=3"></script>
    <script src="js/data/powersets/broad-sword.js?v=3"></script>
    <script src="js/data/powersets/claws.js?v=3"></script>
    <script src="js/data/powersets/dark-melee.js?v=3"></script>
    <script src="js/data/powersets/dual-blades.js?v=3"></script>
    <script src="js/data/powersets/electrical-melee.js?v=3"></script>
    <script src="js/data/powersets/energy-melee.js?v=3"></script>
    <script src="js/data/powersets/fiery-melee.js?v=3"></script>
    <script src="js/data/powersets/ice-melee.js?v=3"></script>
    <script src="js/data/powersets/katana.js?v=3"></script>
    <script src="js/data/powersets/kinetic-attack.js?v=3"></script>
    <script src="js/data/powersets/martial-arts.js?v=3"></script>
    <script src="js/data/powersets/psionic-melee.js?v=3"></script>
    <script src="js/data/powersets/quills.js?v=3"></script>
    <script src="js/data/powersets/radiation-melee.js?v=3"></script>
    <script src="js/data/powersets/savage-melee.js?v=3"></script>
    <script src="js/data/powersets/staff-fighting.js?v=3"></script>
    <script src="js/data/powersets/stone-melee.js?v=3"></script>
    <script src="js/data/powersets/titan-weapons.js?v=3"></script>
    <script src="js/data/powersets/war-mace.js?v=3"></script>
    
    <!-- Scrapper Secondary Powersets (Alphabetical) -->
    <script src="js/data/powersets/bio-organic-armor.js?v=3"></script>
    <script src="js/data/powersets/dark-armor.js?v=3"></script>
    <script src="js/data/powersets/electric-armor.js?v=3"></script>
    <script src="js/data/powersets/energy-aura.js?v=3"></script>
    <script src="js/data/powersets/fiery-aura.js?v=3"></script>
    <script src="js/data/powersets/ice-armor.js?v=3"></script>
    <script src="js/data/powersets/invulnerability.js?v=3"></script>
    <script src="js/data/powersets/ninjitsu.js?v=3"></script>
    <script src="js/data/powersets/psionic-armor.js?v=3"></script>
    <script src="js/data/powersets/radiation-armor.js?v=3"></script>
    <script src="js/data/powersets/regeneration.js?v=3"></script>
    <script src="js/data/powersets/shield-defense.js?v=3"></script>
    <script src="js/data/powersets/stone-armor.js?v=3"></script>
    <script src="js/data/powersets/super-reflexes.js?v=3"></script>
    <script src="js/data/powersets/willpower.js?v=3"></script>
    
    <!-- Defender Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/cold-domination.js?v=3"></script>
    <script src="js/data/powersets/dark-miasma.js?v=3"></script>
    <script src="js/data/powersets/empathy.js?v=3"></script>
    <script src="js/data/powersets/force-field.js?v=3"></script>
    <script src="js/data/powersets/kinetics.js?v=3"></script>
    <script src="js/data/powersets/marine-affinity.js?v=3"></script>
    <script src="js/data/powersets/nature-affinity.js?v=3"></script>
    <script src="js/data/powersets/pain-domination.js?v=3"></script>
    <script src="js/data/powersets/poison.js?v=3"></script>
    <script src="js/data/powersets/radiation-emission.js?v=3"></script>
    <script src="js/data/powersets/shock-therapy.js?v=3"></script>
    <script src="js/data/powersets/sonic-debuff.js?v=3"></script>
    <script src="js/data/powersets/storm-summoning.js?v=3"></script>
    <script src="js/data/powersets/thermal-radiation.js?v=3"></script>
    <script src="js/data/powersets/time-manipulation.js?v=3"></script>
    <script src="js/data/powersets/traps.js?v=3"></script>
    <script src="js/data/powersets/trick-arrow.js?v=3"></script>
    <!-- Note: Defender secondaries use Blaster primaries (already loaded above) -->
    
    <!-- Controller Primary Powersets (Alphabetical) -->
    <script src="js/data/powersets/arsenal-control.js?v=3"></script>
    <script src="js/data/powersets/darkness-control.js?v=3"></script>
    <script src="js/data/powersets/earth-control.js?v=3"></script>
    <script src="js/data/powersets/electric-control.js?v=3"></script>
    <script src="js/data/powersets/fire-control.js?v=3"></script>
    <script src="js/data/powersets/gravity-control.js?v=3"></script>
    <script src="js/data/powersets/ice-control.js?v=3"></script>
    <script src="js/data/powersets/illusion-control.js?v=3"></script>
    <script src="js/data/powersets/mind-control.js?v=3"></script>
    <script src="js/data/powersets/plant-control.js?v=3"></script>
    <script src="js/data/powersets/pyrotechnic-control.js?v=3"></script>
    <script src="js/data/powersets/symphony-control.js?v=3"></script>
    <script src="js/data/powersets/wind-control.js?v=3"></script>
    
    <!-- Controller Secondary Powersets -->
    <script src="js/data/powersets/darkness-affinity.js?v=3"></script>
    <!-- Note: Other Controller secondaries use Defender primaries (already loaded above) -->
    
    <!-- Tanker Secondary Powersets (Melee) -->
    <script src="js/data/powersets/spines.js?v=3"></script>
    <script src="js/data/powersets/super-strength.js?v=3"></script>
    <!-- Note: Tanker primaries use Scrapper secondaries (already loaded above) -->
    <!-- Note: Other Tanker secondaries use Scrapper primaries (already loaded above) -->
    
    <!-- Sentinel Powersets -->
    <!-- Note: Sentinel primaries use Blaster primaries (already loaded above) -->
    <!-- Note: Sentinel secondaries use Scrapper secondaries (already loaded above) -->
    
    <!-- Dominator Secondary Powersets (Assault) -->
    <script src="js/data/powersets/arsenal-assault.js?v=3"></script>
    <script src="js/data/powersets/dark-assault.js?v=3"></script>
    <script src="js/data/powersets/earth-assault.js?v=3"></script>
    <script src="js/data/powersets/electricity-assault.js?v=3"></script>
    <script src="js/data/powersets/energy-assault.js?v=3"></script>
    <script src="js/data/powersets/fiery-assault.js?v=3"></script>
    <script src="js/data/powersets/icy-assault.js?v=3"></script>
    <script src="js/data/powersets/martial-assault.js?v=3"></script>
    <script src="js/data/powersets/psionic-assault.js?v=3"></script>
    <script src="js/data/powersets/radioactive-assault.js?v=3"></script>
    <script src="js/data/powersets/savage-assault.js?v=3"></script>
    <script src="js/data/powersets/sonic-assault.js?v=3"></script>
    <script src="js/data/powersets/thorny-assault.js?v=3"></script>
    <!-- Note: Dominator primaries use Controller primaries (already loaded above) -->
    
    <!-- Brute Powersets -->
    <!-- Note: Brute primaries use Scrapper primaries + Tanker exclusives (already loaded above) -->
    <!-- Note: Brute secondaries use Scrapper secondaries (already loaded above) -->
    
    <!-- Corruptor Secondary Powersets (Buff/Debuff) -->
    <script src="js/data/powersets/sonic-resonance.js"></script>
    <!-- Note: Corruptor primaries use Blaster primaries (already loaded above) -->
    <!-- Note: Other Corruptor secondaries use Defender primaries (already loaded above) -->
    
    <!-- Stalker Primary Powersets (Melee) -->
    <script src="js/data/powersets/ninja-sword.js?v=3"></script>
    <!-- Note: Other Stalker primaries use Scrapper primaries (already loaded above) -->
    <!-- Note: Stalker secondaries use Scrapper secondaries (already loaded above) -->
    
    <!-- Mastermind Primary Powersets (Pet Summoning) -->
    <script src="js/data/powersets/beast-mastery.js?v=3"></script>
    <script src="js/data/powersets/demon-summoning.js?v=3"></script>
    <script src="js/data/powersets/mercenaries.js?v=3"></script>
    <script src="js/data/powersets/necromancy.js?v=3"></script>
    <script src="js/data/powersets/ninjas.js?v=3"></script>
    <script src="js/data/powersets/robotics.js?v=3"></script>
    <script src="js/data/powersets/thugs.js?v=3"></script>
    <!-- Note: Mastermind secondaries use Defender/Controller primaries (already loaded above) -->
    
    <!-- Powerset Auto-Loader (registers all loaded powersets) -->
    <script src="js/data/powersets-loader.js"></script>
    
    <script src="js/data/power-pools.js"></script>
    <script src="js/data/io-sets.js"></script>
    <script src="js/data/enhancements.js"></script>
    <script src="js/data/level-progression.js"></script>
    <script src="js/app.js"></script>
    <script src="js/build.js"></script>
    <script src="js/icons.js"></script>
    <script src="js/damage-calculation.js"></script>  <!-- Damage calculation with level tables -->
    <script src="js/ui.js"></script>  <!-- MOVED BEFORE character-creator.js -->
    <script src="js/enhancement-values.js"></script>  <!-- Enhancement value parsing and calculations -->
    <script src="js/tooltips/unified-tooltips.js"></script>
    <script src="js/tooltips/tooltip-improvements.js"></script>
    <script src="js/character-creator.js"></script>
    <script src="js/enhancement-filtering.js"></script>
    <script src="js/drag-selection.js"></script>
    <script src="js/enhancement-selector.js"></script>
    <script src="js/rule-of-five.js"></script>
    <script src="js/stats.js"></script>
    <script src="js/debug.js"></script>
</body>
</html>
